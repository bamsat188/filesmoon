<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Filesmoon</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:system-ui,sans-serif;
}

/* PLAYER */
#playerBox{
  position:relative;
  max-width:960px;
  margin:20px auto;
  aspect-ratio:16/9;
  background:#000;
  border-radius:14px;
  overflow:hidden;
}

iframe{
  width:100%;
  height:100%;
  border:0;
}

/* overlay awal */
#playerOverlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.55);
  font-size:32px;
  cursor:pointer;
  z-index:10;
}

/* overlay jebakan invisible */
#playerOverlay.hidden-trigger{
  background:transparent;
  color:transparent;
  pointer-events:auto;
}
</style>
</head>

<body>

<div id="playerBox">
  <iframe id="player" allowfullscreen allow="autoplay; fullscreen"></iframe>
  <div id="playerOverlay">PLAY</div>
</div>

<script>
/* ===============================
   CONFIG (PUNYA KAMU)
================================ */
const API = "https://api.filesmoon.site/videos";
const DIRECT_LINK = "https://play.filesmoon.site/ads/go.html";
const AD_DELAY = 45000;

/* ===============================
   ELEMENT
================================ */
const overlay = document.getElementById("playerOverlay");
const player  = document.getElementById("player");
const box     = document.getElementById("playerBox");

/* ===============================
   STATE
================================ */
let FILES = [];
let adTimer = null;
let triggerReady = false;

/* ===============================
   ADS LOGIC
================================ */
function armAdTrigger(){
  clearTimeout(adTimer);
  triggerReady = false;

  adTimer = setTimeout(()=>{
    triggerReady = true;
    overlay.style.display = "flex";
    overlay.classList.add("hidden-trigger");
  }, AD_DELAY);
}

function fireAd(){
  if(!triggerReady) return;

  triggerReady = false;
  overlay.style.display = "none";
  overlay.classList.remove("hidden-trigger");

  window.open(DIRECT_LINK, "_blank");
  armAdTrigger();
}

/* ===============================
   PLAY
================================ */
overlay.onclick = () => {
  overlay.style.display = "none";
  overlay.classList.remove("hidden-trigger");
  armAdTrigger();
};

/* trigger dari interaksi user */
box.addEventListener("pointerdown", fireAd);
box.addEventListener("touchstart", fireAd);

/* ===============================
   LOAD VIDEO DARI API
================================ */
fetch(API)
  .then(r => r.json())
  .then(data => {
    FILES = data?.result?.files || [];
    if(!FILES.length) return;

    const v = FILES[0]; // video pertama
    player.src = `https://filemoon.to/e/${v.file_code}`;
  });

</script>

</body>
</html>
